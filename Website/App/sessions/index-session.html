<div class="row">
    <div class="col-sm-6">
        <p>Start: {{vm.session.start | appDate}}</p>
        <p>End: {{vm.session.end | appDate}}</p>
        <p>Duration: {{vm.duration()}} minutes</p>
        <p>Price: {{vm.session.price | currency:'$'}}</p>
        <!--<p>Partner: {{vm.session.userDisplayName}}<span ng-show="vm.event.userSkype">. Skype name: <strong>{{vm.session.userSkype}}</strong></span></p>-->
    </div>
    <div class="col-sm-6">
        <p>Requested by <strong>{{vm.guestUser.displayName}}</strong> at {{vm.session.requestTime | appDate}}</p>
        <p ng-show="!vm.session.confirmationTime">Not confirmed by <strong>{{vm.hostUser.displayName}}</strong></p>
        <p ng-show="vm.session.confirmationTime">Confirmed by <strong>{{vm.hostUser.displayName}}</strong> at {{vm.session.confirmationTime | appDate}}</p>
        <p ng-show="vm.session.cancellationTime">Cancelled by <strong>{{vm.cancellationUser.displayName}}</strong> at {{vm.session.cancellationTime | appDate}}</p>
    </div>
</div>
<div ng-cloak>
    <button class="btn btn-default btn-success" ng-if="vm.canConfirm()" ng-click="vm.modalSessionAction(vm.modalParams.confirm)">Confirm session</button>
    <button class="btn btn-default btn-danger" ng-if="vm.canCancel()" ng-click="vm.modalSessionAction(vm.modalParams.cancel)">Cancel session</button>
    <button class="btn btn-default btn-danger" ng-if="vm.canDispute()" ng-click="vm.modalSessionAction(vm.modalParams.dispute)">Dispute session payment</button>
</div>
<br />
<br />
<div class="row">
    <div class="col-md-offset-2 col-md-8">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Messages</h3>
            </div>
            <div class="panel-body" style="padding-bottom:20px;">
                <ul>
                    <li ng-repeat="m in vm.messages">
                        <p ng-style="vm.isUnread(m) ? {'font-weight':'bold'} : {}">
                            From: {{m.senderDisplayName}} &nbsp;&nbsp;To: {{m.recipientDisplayName}} &nbsp;&nbsp;{{m.postTime | appDateTime}}
                            <a href="" class="app-margin-left-half" ng-click="m.showText = !m.showText; vm.loadMessageText(m);" ng-style="m.text === '' ? {color:'#bbb'} : {}">
                                {{m.showText ? 'Hide' : 'Show'}}<i class="fa fa-fw" ng-class="m.showText ? 'fa-chevron-left' : 'fa-chevron-right'"></i>
                            </a>
                        </p>
                        <p class="app-pre-line" ng-show="m.showText">{{m.text}}</p>
                    </li>
                </ul>
                <hr />
                <button class="btn btn-default" ng-click="vm.modalSessionAction(vm.modalParams.sendMessage)">Send message</button>
            </div>
        </div>
    </div>
</div>
<div class="row app-margin-top" ng-show="vm.canShowSkype()">
    <div class="col-md-6">
        <p>
            <img class="app-2px-up" src="http://www.skypeassets.com/i/scom/images/skype-buttons/Skypeicon_24px.png" width="24" height="24" />
            The name of <strong>{{vm.otherUser.displayName}}</strong> on Skype is
            <!-- Skyp Button is a bloatware, it is essentially a wrapper around Skype URI anyway, and it does not support the 'add' method -->
            <a href="skype:{{vm.otherUser.skypeName}}?add"><strong>{{vm.otherUser.skypeName}}</strong></a>
        </p>
        <p>
            <span class="text-danger"><strong>Note:</strong></span> Because of the Skype security and privacy policy, you need first to send the person a contact request.
            Click <strong>Add to Contacts</strong> in the Skype client program and enter some text to introduce yourself. When you are done, click <strong>Send</strong>.
            Although the new contact is added to your contact list, you will only see a question mark
            <img class="app-1px-up" src="/content/images/skype-no-contact.png" width="14" height="14" />
            as their status icon until they accept your request.
            When your new contact accepts your request, you will see when they are online and will be able to make free voice and video calls with them.
        </p>
    </div>
    <div class="col-md-6">
        <img class="img-thumbnail" src="/content/images/skype-add-contact.png" width="340" height="240" />
    </div>
</div>
<hr/>
<h4>Activity suggestions for the conversation</h4>
<ul>
    <li><a href="/games/pick-a-pic">Game "Pick a picture"</a></li>
    <li><a href="http://iteslj.org/questions/" target="_blank">Topic questions</a></li>
</ul>

<!-- Modals -->
<!-- sessionActionModal -->
<script type="text/ng-template" id="sessionActionModal">
    <div class="modal-header">
        <h3>{{vm.header}}</h3>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-md-offset-1 col-md-10">
                <div class="form-group">
                    <label for="messageTextarea">Your message</label>
                    <textarea class="form-control" id="messageTextarea" ng-model="vm.message" maxlength="980" />
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary app-btn-disablable" ng-click="vm.ok()" ng-disabled="vm.sending">OK</button>
        <a href="" class="app-close" ng-click="vm.cancel()">Close</a>
    </div>
</script>
<!-- /sessionActionModal -->
<!-- /Modals -->
